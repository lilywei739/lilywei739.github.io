<h1 id="section">对象的克隆</h1>

<p>之前同事问过我这个问题，但是当时没有回答出来，今天有时间梳理记录一下；</p>

<h2 id="section-1">什么是对象？</h2>
<blockquote>
  <p>from W3School <br /> 
JavaScript 中的所有事物都是对象：字符串、数值、数组、函数…</p>
</blockquote>

<h2 id="section-2">对象的克隆又分哪几种？</h2>
<blockquote>
  <p>浅克隆<br />
深克隆</p>
</blockquote>

<div class="highlighter-rouge"><pre class="highlight"><code>//字符型
var a="abc";
var b=a;
b="def";
 
alert(a);   // "abc"
alert(b);   // "def"
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>//数值型
var a=1;
var b=a;
b=2;
 
alert(a);   // 1 
alert(b);   // 2 
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>//布尔型
var a=true;
var b=a;
b=false;
 
alert(a);   // true 
alert(b);   // flase 
</code></pre>
</div>

<p>2）引用对象的拷贝，就相当于新建了一个指针，新老对象都指向了同一个对象，其中任何一个有修改，另一个必会受到影响。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>// 数组类型的浅拷贝
var a=[1,2];
var b=a;
b.push(3);

alert(a);   // 1,2,3
alert(b);   // 1,2,3
</code></pre>
</div>

<p>由上可知，原始数组a，克隆数组b，修改了克隆数组b，但也同时修改了原始数组a，这就是引用对象的特点。</p>

<p>那上面的例子怎样才能完整的拷贝呢？就是上文提到的—-<strong>深拷贝</strong>。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>// 数组类型的深拷贝
var a=[1,2],
    b=[];
for(var i = 0; i &lt; a.length; i = i + 1){
    b[i]=a[i];
}
b.push(3);
 
console.log(a);   // [1,2]
console.log(b);   // [1,2,3]
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>// 对象类型的深拷贝
var x={a:2,b:4},
    y={},
    i;
for(i in x){
    y[i]=x[i];
}
y.c=6;
 
console.log(x);   // Object {a: 2, b: 4} 
console.log(y);   // Object {a: 2, b: 4, c: 6}
</code></pre>
</div>

<h3 id="section-3">思路</h3>

<p>通过上面的例子可以看出，要克隆引用型对象必须采用深克隆，包括对象的值也是一个对象的话，也要进行深克隆；原始类型对象直接用“=”就能拷贝。</p>

<p>思路如下：</p>

<blockquote>
  <p>1、先判断对象的类型<br />
2、如是该属性是object，则特殊处理<br />
     1) 如是该对象是个数组，就创建一个新的数组并深克隆数组里的元素<br />
     2) 如果是非数组对象，就对它递归调用深克隆方法<br />
3、如果不是object,就直接“=”克隆</p>
</blockquote>

<h3 id="section-4">实现：</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>function cloneObject(src) {
    var result ;//返回的复制后的结果。
    if (typeof(src)==="object"){
	for (var i in src){
	    result[i] = cloneObject(src[i]);  
	}
    }else{
        //对于原始类型直接赋值。
        result = src;
    }
    return result;
}
</code></pre>
</div>

